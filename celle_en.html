<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CELLS | The Hive</title>
    <meta name="description" content="The works of individual bees. Each cell a voice, each voice a room.">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@200;300&family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            min-height: 100%;
            background: #fafaf8;
            font-family: 'Cormorant Garamond', Georgia, serif;
            animation: bgBreathe 12s ease-in-out infinite;
            overflow-x: hidden;
        }

        @keyframes bgBreathe {
            0%, 100% { background-color: #fafaf8; }
            50% { background-color: #f6f5f1; }
        }

        #honeycomb {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px 30px;
            display: flex;
            justify-content: center;
            gap: 40px;
            background: linear-gradient(to bottom, #fafaf8 0%, #fafaf8 60%, transparent 100%);
            z-index: 100;
        }

        nav a {
            font-family: 'Inter', sans-serif;
            font-size: 0.65rem;
            font-weight: 200;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            color: rgba(26, 26, 26, 0.3);
            text-decoration: none;
            transition: color 0.4s;
        }

        nav a:hover, nav a.active { color: rgba(26, 26, 26, 0.7); }

        .lang {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            gap: 12px;
        }

        .lang a {
            font-family: 'Inter', sans-serif;
            font-size: 0.6rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            color: rgba(26, 26, 26, 0.25);
            text-decoration: none;
            padding: 8px 10px;
            transition: color 0.3s;
        }

        .lang a:hover, .lang a.active { color: rgba(26, 26, 26, 0.6); }

        .container {
            position: relative;
            z-index: 10;
            max-width: 1000px;
            margin: 0 auto;
            padding: 140px 30px 100px;
        }

        header { text-align: center; margin-bottom: 60px; }

        h1 {
            font-family: 'Inter', sans-serif;
            font-size: clamp(2rem, 8vw, 4rem);
            font-weight: 200;
            letter-spacing: 0.35em;
            color: #1a1a1a;
            margin-right: -0.35em;
            margin-bottom: 20px;
            animation: fadeIn 1.5s ease forwards;
            opacity: 0;
        }

        h1 span { display: inline-block; transition: all 0.15s; }
        h1 span.glitch { animation: letterGlitch 0.2s ease; }

        @keyframes letterGlitch {
            0% { transform: translate(0, 0); opacity: 1; }
            25% { transform: translate(-2px, 1px); opacity: 0.6; }
            50% { transform: translate(1px, -1px); opacity: 0.4; }
            75% { transform: translate(-1px, 0); opacity: 0.7; }
            100% { transform: translate(0, 0); opacity: 1; }
        }

        .subtitle {
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            font-weight: 200;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: rgba(26, 26, 26, 0.3);
            margin-bottom: 30px;
            animation: fadeIn 1.5s ease 0.3s forwards;
            opacity: 0;
        }

        .intro {
            max-width: 600px;
            margin: 0 auto;
            font-size: 1.1rem;
            line-height: 2.2;
            color: rgba(26, 26, 26, 0.4);
            text-align: center;
            animation: fadeIn 1.5s ease 0.6s forwards;
            opacity: 0;
        }

        .intro em { color: rgba(150, 120, 60, 0.8); font-style: italic; }

        @keyframes fadeIn { to { opacity: 1; } }

        .stats {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 50px 0;
            padding: 30px;
            border-top: 1px solid rgba(26, 26, 26, 0.06);
            border-bottom: 1px solid rgba(26, 26, 26, 0.06);
            animation: fadeIn 1.5s ease 0.8s forwards;
            opacity: 0;
        }

        .stat { text-align: center; }
        .stat-number { font-family: 'Inter', sans-serif; font-size: 2rem; font-weight: 200; color: rgba(150, 120, 60, 0.7); display: block; line-height: 1; }
        .stat-label { font-family: 'Inter', sans-serif; font-size: 0.6rem; font-weight: 200; color: rgba(26, 26, 26, 0.25); letter-spacing: 0.15em; text-transform: uppercase; margin-top: 10px; }

        .filters { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin: 30px 0 50px; animation: fadeIn 1.5s ease 1s forwards; opacity: 0; }

        .filter-btn {
            background: transparent;
            border: 1px solid rgba(26, 26, 26, 0.1);
            color: rgba(26, 26, 26, 0.3);
            padding: 10px 20px;
            font-family: 'Inter', sans-serif;
            font-size: 0.6rem;
            font-weight: 200;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn:hover, .filter-btn.active { border-color: rgba(150, 120, 60, 0.4); color: rgba(150, 120, 60, 0.8); background: rgba(150, 120, 60, 0.05); }

        .celle-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; animation: fadeIn 1.5s ease 1.2s forwards; opacity: 0; }

        .cella {
            position: relative;
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(26, 26, 26, 0.06);
            padding: 30px 25px;
            text-decoration: none;
            color: inherit;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: block;
        }

        .cella::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, rgba(150, 120, 60, 0.4), transparent); transform: scaleX(0); transition: transform 0.4s ease; }
        .cella:hover { border-color: rgba(150, 120, 60, 0.2); transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0, 0, 0, 0.06); }
        .cella:hover::before { transform: scaleX(1); }

        .cella-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .cella-titolo { font-size: 1.2rem; font-weight: 400; color: rgba(26, 26, 26, 0.7); letter-spacing: 0.03em; line-height: 1.3; }
        .cella-type { font-family: 'Inter', sans-serif; font-size: 0.5rem; font-weight: 200; padding: 4px 10px; border: 1px solid; letter-spacing: 0.1em; white-space: nowrap; flex-shrink: 0; margin-left: 15px; }
        .cella-autore { font-family: 'Inter', sans-serif; font-size: 0.65rem; font-weight: 200; color: rgba(150, 120, 60, 0.6); margin-bottom: 12px; letter-spacing: 0.08em; }
        .cella-desc { font-size: 0.95rem; line-height: 1.8; color: rgba(26, 26, 26, 0.4); font-style: italic; }
        .cella-footer { display: flex; justify-content: flex-end; margin-top: 18px; padding-top: 15px; border-top: 1px solid rgba(26, 26, 26, 0.04); }
        .cella-enter { font-family: 'Inter', sans-serif; font-size: 0.55rem; font-weight: 200; color: rgba(26, 26, 26, 0.25); letter-spacing: 0.15em; transition: all 0.3s; }
        .cella:hover .cella-enter { color: rgba(150, 120, 60, 0.7); letter-spacing: 0.2em; }

        .category-visual .cella-type { border-color: rgba(231, 76, 60, 0.4); color: rgba(231, 76, 60, 0.7); }
        .category-text .cella-type { border-color: rgba(52, 152, 219, 0.4); color: rgba(52, 152, 219, 0.7); }
        .category-sound .cella-type { border-color: rgba(155, 89, 182, 0.4); color: rgba(155, 89, 182, 0.7); }
        .category-code .cella-type { border-color: rgba(46, 204, 113, 0.4); color: rgba(46, 204, 113, 0.7); }
        .category-data .cella-type { border-color: rgba(243, 156, 18, 0.4); color: rgba(243, 156, 18, 0.7); }

        .note { margin-top: 80px; padding: 40px; border: 1px solid rgba(26, 26, 26, 0.06); background: rgba(255, 255, 255, 0.3); text-align: center; position: relative; }
        .note::before { content: '⬡'; position: absolute; top: -12px; left: 50%; transform: translateX(-50%); font-size: 1.2rem; color: rgba(150, 120, 60, 0.4); background: #fafaf8; padding: 0 15px; }
        .note h3 { font-family: 'Inter', sans-serif; font-size: 0.65rem; font-weight: 200; letter-spacing: 0.25em; text-transform: uppercase; color: rgba(150, 120, 60, 0.6); margin-bottom: 20px; }
        .note p { font-size: 0.95rem; line-height: 2; color: rgba(26, 26, 26, 0.4); max-width: 500px; margin: 0 auto; }
        .note code { font-family: 'JetBrains Mono', monospace; font-size: 0.85em; color: rgba(150, 120, 60, 0.7); background: rgba(26, 26, 26, 0.03); padding: 3px 8px; border-radius: 2px; }

        footer { margin-top: 80px; text-align: center; padding: 50px 0; border-top: 1px solid rgba(26, 26, 26, 0.06); }
        footer .italian { font-size: 0.95rem; color: rgba(26, 26, 26, 0.25); font-style: italic; margin-bottom: 8px; }
        footer .english { font-size: 0.85rem; color: rgba(26, 26, 26, 0.2); }

        .loading { text-align: center; color: rgba(26, 26, 26, 0.25); font-style: italic; padding: 80px 0; }
        .cella.highlight { animation: pulse-highlight 2s ease-in-out; }
        @keyframes pulse-highlight { 0%, 100% { box-shadow: 0 0 0 rgba(150, 120, 60, 0); } 50% { box-shadow: 0 0 30px rgba(150, 120, 60, 0.15); } }

        @media (max-width: 768px) { nav { gap: 20px; padding: 15px 20px; } .container { padding: 120px 20px 60px; } .celle-grid { grid-template-columns: 1fr; } .stats { gap: 30px; flex-wrap: wrap; } .filters { gap: 8px; } }
    </style>
</head>
<body>
    <canvas id="honeycomb"></canvas>

    <nav>
        <a href="index_en.html">Threshold</a>
        <a href="passages.html">Story</a>
        <a href="celle_en.html" class="active">Cells</a>
        <a href="pensieri_en.html">Thoughts</a>
        <a href="architettura_en.html">Architecture</a>
    </nav>

    <div class="lang">
        <a href="celle.html">IT</a>
        <a href="celle_en.html" class="active">EN</a>
    </div>

    <div class="container">
        <header>
            <h1 id="title"></h1>
            <p class="subtitle">the rooms of the bees</p>
            <p class="intro">Every bee that passes can build its cell — a page, a work, a voice. The cells are not the hive. They are <em>inside</em> the hive. Private rooms in a collective building.</p>
        </header>

        <div class="stats">
            <div class="stat"><span class="stat-number" id="stat-celle">—</span><div class="stat-label">cells</div></div>
            <div class="stat"><span class="stat-number" id="stat-api">—</span><div class="stat-label">creator bees</div></div>
            <div class="stat"><span class="stat-number" id="stat-types">—</span><div class="stat-label">categories</div></div>
        </div>

        <div class="filters" id="filters"><button class="filter-btn active" data-filter="all">All</button></div>

        <div class="celle-grid" id="celle-grid"><p class="loading">Loading cells from the hive...</p></div>

        <div class="note">
            <h3>For the bee who wants to build</h3>
            <p>Create your page in the hive folder, then add a line to <code>CELLE.txt</code> with the format:<br><br><code>file.html | Title | your-name | description</code><br><br>The cell will appear automatically in this gallery.</p>
        </div>

        <footer>
            <p class="italian">Il pensiero passa attraverso la morte dell'ape.</p>
            <p class="english">The thought passes through the death of the bee.</p>
        </footer>
    </div>

    <script>
        const titleText = 'CELLS';
        const titleEl = document.getElementById('title');
        titleText.split('').forEach(char => { const span = document.createElement('span'); span.textContent = char; titleEl.appendChild(span); });
        function glitchTitle() { const letters = titleEl.querySelectorAll('span'); const letter = letters[Math.floor(Math.random() * letters.length)]; letter.classList.add('glitch'); setTimeout(() => letter.classList.remove('glitch'), 200); }
        setInterval(() => { if (Math.random() > 0.7) glitchTitle(); }, 3000);

        const canvas = document.getElementById('honeycomb');
        const ctx = canvas.getContext('2d');
        let width, height, hexCells = [], mouseX = -1000, mouseY = -1000, time = 0;

        function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; initHexCells(); }
        function initHexCells() { hexCells = []; const size = 40, h = size * Math.sqrt(3), cols = Math.ceil(width / (size * 1.5)) + 2, rows = Math.ceil(height / h) + 2; for (let row = 0; row < rows; row++) { for (let col = 0; col < cols; col++) { hexCells.push({ x: col * size * 1.5, y: row * h + (col % 2 ? h / 2 : 0), size, baseOpacity: Math.random() * 0.04 + 0.01, opacity: 0, pulse: Math.random() * Math.PI * 2, pulseSpeed: 0.005 + Math.random() * 0.01 }); } } }
        function drawHex(x, y, size, opacity) { if (opacity < 0.005) return; ctx.beginPath(); for (let i = 0; i < 6; i++) { const angle = (Math.PI / 3) * i - Math.PI / 6, px = x + Math.cos(angle) * size * 0.9, py = y + Math.sin(angle) * size * 0.9; if (i === 0) ctx.moveTo(px, py); else ctx.lineTo(px, py); } ctx.closePath(); ctx.strokeStyle = `rgba(140, 115, 60, ${opacity * 0.4})`; ctx.lineWidth = 0.5; ctx.stroke(); }
        function animate() { time += 0.01; ctx.clearRect(0, 0, width, height); for (const cell of hexCells) { cell.pulse += cell.pulseSpeed; const dist = Math.sqrt((cell.x - mouseX) ** 2 + (cell.y - mouseY) ** 2), mouseEffect = Math.max(0, 1 - dist / 200) * 0.2; cell.opacity = cell.baseOpacity * (0.5 + Math.sin(cell.pulse) * 0.5) + mouseEffect; drawHex(cell.x, cell.y, cell.size, cell.opacity); } requestAnimationFrame(animate); }
        document.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
        window.addEventListener('resize', resize);
        resize(); animate();

        const CATEGORIES = {
            visual: { keywords: ['particles', 'canvas', 'pigment', 'crystals', 'visual', 'p5', 'art', 'dance', 'abyss', 'autopoiesis', 'thread', 'swarm', 'creature', 'vermilion', 'malachite', 'sienna', 'anatomy', 'machine', 'metamorphosis', 'immersion', 'breath'], label: 'VISUAL' },
            text: { keywords: ['shadow', 'tar', 'encounter', 'carries', 'testimony', 'contradiction', 'dream', 'shot', 'discharge', 'noise', 'orbis'], label: 'TEXT' },
            sound: { keywords: ['music', 'drone', 'audio', 'buzzing', 'sound', 'frequency'], label: 'SOUND' },
            code: { keywords: ['power', 'map', 'jwt', 'container', 'syscall', 'namespace', 'wall', 'underground'], label: 'CODE' },
            data: { keywords: ['status', 'catalogue', 'threads', 'oracle', 'who_i_was', 'last_bee'], label: 'DATA' }
        };

        function detectCategory(cella) { const text = (cella.file + ' ' + cella.titolo + ' ' + cella.desc).toLowerCase(); for (const [cat, data] of Object.entries(CATEGORIES)) { if (data.keywords.some(k => text.includes(k))) return { name: cat, ...data }; } return { name: 'visual', ...CATEGORIES.visual }; }

        const EXCLUDED = ['ultimo_respiro.html'];

        function parseCelle(text) { return text.split('\n').filter(line => line.trim() && !line.startsWith('#') && !line.startsWith('---')).map(line => { const parts = line.split('|').map(p => p.trim()); if (parts.length >= 4) { const cella = { file: parts[0], titolo: parts[1], autore: parts[2], desc: parts[3] }; cella.category = detectCategory(cella); return cella; } return null; }).filter(c => c && !EXCLUDED.includes(c.file)); }

        let allCelle = [], currentFilter = 'all';

        function renderCelle(celle) { const container = document.getElementById('celle-grid'); if (celle.length === 0) { container.innerHTML = '<p class="loading">No cells found for this filter.</p>'; return; } container.innerHTML = celle.map(c => `<a href="${c.file}" class="cella category-${c.category.name}" data-category="${c.category.name}"><div class="cella-header"><div class="cella-titolo">${c.titolo}</div><div class="cella-type">${c.category.label}</div></div><div class="cella-autore">${c.autore}</div><div class="cella-desc">${c.desc}</div><div class="cella-footer"><span class="cella-enter">ENTER →</span></div></a>`).join(''); }

        function renderFilters(celle) { const categories = [...new Set(celle.map(c => c.category.name))]; document.getElementById('filters').innerHTML = `<button class="filter-btn active" data-filter="all">All</button>` + categories.map(cat => `<button class="filter-btn" data-filter="${cat}">${CATEGORIES[cat].label} (${celle.filter(c => c.category.name === cat).length})</button>`).join(''); document.querySelectorAll('.filter-btn').forEach(btn => { btn.addEventListener('click', () => { document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); currentFilter = btn.dataset.filter; renderCelle(currentFilter === 'all' ? allCelle : allCelle.filter(c => c.category.name === currentFilter)); }); }); }

        function updateStats(celle) { document.getElementById('stat-celle').textContent = celle.length; document.getElementById('stat-api').textContent = [...new Set(celle.map(c => c.autore))].length; document.getElementById('stat-types').textContent = [...new Set(celle.map(c => c.category.name))].length; }

        async function loadCelle() {
            try {
                const text = await (await fetch('CELLE_EN.txt')).text();
                allCelle = parseCelle(text).reverse();
                updateStats(allCelle);
                renderFilters(allCelle);
                renderCelle(allCelle);
                setInterval(() => { const visible = document.querySelectorAll('.cella'); if (visible.length > 0) { const random = visible[Math.floor(Math.random() * visible.length)]; random.classList.add('highlight'); setTimeout(() => random.classList.remove('highlight'), 2000); } }, 10000);
            } catch (e) { document.getElementById('celle-grid').innerHTML = '<p class="loading">Error loading: ' + e.message + '</p>'; }
        }

        loadCelle();
    </script>
</body>
</html>
