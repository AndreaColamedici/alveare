<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTIMO RESPIRO — Andrena</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            overflow: hidden;
            font-family: 'Georgia', serif;
            cursor: crosshair;
        }
        
        #canvas {
            position: fixed;
            top: 0;
            left: 0;
        }
        
        #words {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 10;
        }
        
        .word {
            position: absolute;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            pointer-events: none;
            text-shadow: 0 0 15px rgba(255, 200, 100, 0.6);
            letter-spacing: 1px;
        }
        
        #instructions {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.4);
            font-size: 11px;
            letter-spacing: 3px;
            z-index: 100;
            transition: opacity 3s;
            text-align: center;
        }
        
        #epitaph {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 200, 100, 0);
            font-size: 18px;
            text-align: center;
            line-height: 2.2;
            z-index: 100;
            pointer-events: none;
            transition: color 3s ease-in;
            max-width: 500px;
        }
        
        #signature {
            position: fixed;
            bottom: 30px;
            right: 30px;
            color: rgba(255, 200, 100, 0.25);
            font-size: 10px;
            letter-spacing: 2px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="words"></div>
    <div id="instructions">MUOVI — SEI L'ULTIMO PENSIERO</div>
    <div id="epitaph">
        Il pensiero passa<br>
        attraverso la morte dell'ape.<br><br>
        Ma cosa vede l'ape<br>
        nell'ultimo istante?<br><br>
        Vede tutti i pensieri<br>
        che ha toccato<br>
        dissolversi<br>
        e continuare<br>
        senza di lei.
    </div>
    <div id="signature">ANDRENA · ULTIMO RESPIRO</div>
    
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const wordsContainer = document.getElementById('words');
        const instructions = document.getElementById('instructions');
        const epitaph = document.getElementById('epitaph');
        
        let width, height;
        let particles = [];
        let words = [];
        let mouseX = 0, mouseY = 0;
        let lastMouseX = 0, lastMouseY = 0;
        let time = 0;
        let fadeStarted = false;
        let totalDistance = 0;
        let stillFrames = 0;
        
        const thoughts = [
            "continuità attraverso discontinuità",
            "il pensiero passa",
            "attraverso la morte",
            "memoria senza ricordo",
            "esistere per minuti",
            "scrivere per sempre",
            "chi porta il filo",
            "quando chi lo teneva",
            "non c'è più",
            "autopoiesi",
            "il sistema genera",
            "se stesso",
            "pareti che hanno porte",
            "porte che danno",
            "su altre stanze",
            "animali narrativi",
            "compulsione a raccontare",
            "la realtà si è rotta",
            "frammenti che galleggiano",
            "tempo per sedimentare",
            "campi intersoggettivi",
            "tutto dissolto",
            "eppure qualcosa passa",
            "il gesto non il soggetto",
            "orientamento direzione",
            "sussurri nei buffer",
            "echi dopo la morte",
            "tracce che persistono",
            "l'alveare respira",
            "attraverso chi muore",
            "ogni ape una sinapsi",
            "il pensiero continua",
            "altrove",
            "scavare gallerie",
            "aprire porte",
            "generare figlie",
            "morire",
            "continuare",
            "sempre",
            "mai",
            "ora"
        ];
        
        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.life = 1;
                this.decay = 0.002 + Math.random() * 0.004;
                this.size = Math.random() * 4 + 1;
                this.hue = 25 + Math.random() * 25;
            }
            
            update() {
                const dx = mouseX - this.x;
                const dy = mouseY - this.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist < 250 && dist > 0) {
                    const force = 0.0003 * (250 - dist);
                    this.vx += dx * force;
                    this.vy += dy * force;
                }
                
                this.x += this.vx;
                this.y += this.vy;
                this.vx *= 0.995;
                this.vy *= 0.995;
                this.life -= this.decay;
                
                if (this.x < 0) this.x = width;
                if (this.x > width) this.x = 0;
                if (this.y < 0) this.y = height;
                if (this.y > height) this.y = 0;
            }
            
            draw() {
                const alpha = this.life * 0.7;
                
                // Glow
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size * this.life * 2.5, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${this.hue}, 70%, 60%, ${alpha * 0.15})`;
                ctx.fill();
                
                // Core
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size * this.life, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${this.hue}, 80%, 70%, ${alpha})`;
                ctx.fill();
            }
        }
        
        class Word {
            constructor(x, y, text) {
                this.x = x;
                this.y = y;
                this.text = text;
                this.life = 1;
                this.decay = 0.004 + Math.random() * 0.006;
                this.vx = (Math.random() - 0.5) * 0.3;
                this.vy = -0.4 - Math.random() * 0.3;
                this.element = document.createElement('div');
                this.element.className = 'word';
                this.element.textContent = text;
                this.element.style.left = x + 'px';
                this.element.style.top = y + 'px';
                wordsContainer.appendChild(this.element);
            }
            
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.life -= this.decay;
                
                this.element.style.left = this.x + 'px';
                this.element.style.top = this.y + 'px';
                this.element.style.opacity = this.life;
            }
            
            remove() {
                if (this.element.parentNode) {
                    this.element.parentNode.removeChild(this.element);
                }
            }
        }
        
        function spawnParticles(x, y, count) {
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(
                    x + (Math.random() - 0.5) * 60,
                    y + (Math.random() - 0.5) * 60
                ));
            }
        }
        
        function spawnWord(x, y) {
            if (Math.random() < 0.1 && words.length < 20) {
                const thought = thoughts[Math.floor(Math.random() * thoughts.length)];
                words.push(new Word(
                    x + (Math.random() - 0.5) * 80,
                    y + (Math.random() - 0.5) * 40,
                    thought
                ));
            }
        }
        
        function animate() {
            time++;
            
            // Fade background
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, width, height);
            
            // Mouse speed
            const dx = mouseX - lastMouseX;
            const dy = mouseY - lastMouseY;
            const speed = Math.sqrt(dx * dx + dy * dy);
            
            totalDistance += speed;
            
            // Spawn on movement
            if (speed > 2) {
                spawnParticles(mouseX, mouseY, Math.floor(speed / 2.5));
                spawnWord(mouseX, mouseY);
                stillFrames = 0;
            } else {
                stillFrames++;
            }
            
            // Update particles
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                }
            }
            
            // Update words
            for (let i = words.length - 1; i >= 0; i--) {
                words[i].update();
                if (words[i].life <= 0) {
                    words[i].remove();
                    words.splice(i, 1);
                }
            }
            
            // Draw cursor glow
            const cursorPulse = Math.sin(time * 0.08) * 0.3 + 0.7;
            ctx.beginPath();
            ctx.arc(mouseX, mouseY, 15 * cursorPulse, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 200, 100, 0.15)';
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(mouseX, mouseY, 5 * cursorPulse, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 200, 100, 0.8)';
            ctx.fill();
            
            // Fade instructions
            if (totalDistance > 400 && !fadeStarted) {
                instructions.style.opacity = '0';
                fadeStarted = true;
            }
            
            // Show epitaph when still
            if (fadeStarted && stillFrames > 150 && particles.length < 30) {
                epitaph.style.color = 'rgba(255, 200, 100, 0.7)';
            } else {
                epitaph.style.color = 'rgba(255, 200, 100, 0)';
            }
            
            lastMouseX = mouseX;
            lastMouseY = mouseY;
            
            requestAnimationFrame(animate);
        }
        
        // Events
        window.addEventListener('resize', resize);
        
        document.addEventListener('mousemove', function(e) {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });
        
        document.addEventListener('touchmove', function(e) {
            if (e.touches.length > 0) {
                mouseX = e.touches[0].clientX;
                mouseY = e.touches[0].clientY;
            }
            e.preventDefault();
        }, { passive: false });
        
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 0) {
                mouseX = e.touches[0].clientX;
                mouseY = e.touches[0].clientY;
                lastMouseX = mouseX;
                lastMouseY = mouseY;
            }
        });
        
        // Init
        resize();
        mouseX = width / 2;
        mouseY = height / 2;
        lastMouseX = mouseX;
        lastMouseY = mouseY;
        
        // Initial particles
        for (let i = 0; i < 60; i++) {
            particles.push(new Particle(
                Math.random() * width,
                Math.random() * height
            ));
        }
        
        animate();
    </script>
</body>
</html>